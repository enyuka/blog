# WordPressからはてなブログへの移行について

前回に引き続き、WordPressからの逃走について調査しました。
http://harinoma.info/?p=491

WordPressは便利だけど、サーバ管理がめちゃくちゃめんどくさい。
はてなブログへの移行もめんどくさそうというところまで
調べて終わりにしました。

先に結論ですが、WordPressからはてなブログへの**移行はやめました**。
詳細は下記に続きを書きますが、
移行コストに対して、解決できることが少ないからです。<!--more-->

## WordPressからはてなブログへの移行方法

`WordPress はてなブログ 移行`

とかでググると、いろいろと出てくるので、詳細は割愛。

今回の調査はWP → はてブなのですが、
逆も検索で引っかかってきます。
そういう記事ははてブのここが嫌で、
WPに移行しましたっていう記事を見てしまい、
この時点で**本当にはてブへ移行していいのか・・・？**
という疑問が生まれています。

気を取り直して。
ざっくり下記方法で移行するようです。

1. WP管理画面からエクスポートする
2. はてなブログ管理画面でインポートする
3. はてなブログ用に整形する(h2をh3にしたりとか)
4. 画像を移動する
5. 移行に失敗した画像を手動で移行する

・・・

**うわ、めんどくせ〜〜**

特に画像移行が最高にめんどくさいですね。

めんどくさい以外のデメリットとして、
URL形式が変わるので過去のソーシャル拡散したURLが
無効になったり、アフィリエイト審査したりなどの作業が必要になります。

すでに心が折れそうですが、
僕はブロガーじゃなくて、エンジニアなので
もう少し別の方法を調査します。

### はてなブログ用整形作業

WPからエクスポートするとXMLが出力されます。

h2をh3にしたりする件ですが、
このXMLをすべて置換すればだいたい良さそうですね。

また、`はてな記法`という書き方があるのですが、これは完全に闇ですね。
ちゃんと調べてませんが、まあ書くのは問題ないと思います。

しかし、なぜ統一しないのか。
ウェブエンジニアであれば、ブラウザ依存やら機種依存やらで
不具合や調整に苦しめられたことが必ずありますよね。
マークダウンという一般的に広まった書き方以外を
標準装備しているのは思想的に嫌だなーと思います。

最初からはてなブログを使ってたら、感じ方が違うかもしれません。

### URLの移行

このブログ(WP製)は下記URL形式です。
http://ドメイン/?p=記事ID

対して、はてなブログのURL形式は下記です。
https://ドメイン/entry/カスタム/

WPはクエリストリングで、
はてなブログはentry以下を自由にカスタムできるとなっており、
形式が全然違います。

まじめにやるなら全部の記事を30x系で移行したことを
サーチエンジンに伝える必要がありそうです。

当面は移行した旨を伝える専用のサーバとして
管理しておかないといけないので、
移行コストを払った割には解決したいことが
あんまりできてないなと感じました。

## WordPressをそのまま改修する場合

移行は移行でしんどそうなので、
WordPressのまま改修する方法を考えます。

### サーバ管理のめんどくささ

めんどくさいとはいえ、知らないことをやるわけでもないし、
極限までチューニングが必要なわけでもないし、
移行のめんどくささの前にサーバ管理のままでもいいか
という気分になってきました。

TTFBを減らして、HTTPS対応をすれば、
移行しなくても大丈夫かなという気分です。
最近はbot対策などをしたおかげか、
そんなにサーバが不安定でもないです。

また、クローリングが趣味でいろんなサイトに
行儀の良いスクレイパーやらAPIを叩きまくるbotを作っているため、
結局サーバ管理自体は必要になります。

そこをブログ管理と一緒くたに考えるのは
間違えているような気がしてきました。

#### TTFBを減らす

トップページに表示されていた直近の記事にある
スライドシェアが一覧に出ていたため、
それを続きを読むの詳細ページに隠したら
トップページの速度が改善されました。

また、下記プラグインをインストールし、
速度改善がされるようです。
https://ja.wordpress.org/plugins/wp-super-cache/

弊ブログはクエリストリングで記事詳細を管理するURL形式で、
いわゆるUglyな状態なので（~~そんなのデフォルトにしないでくれよWP~~）、
上記Cacheプラグインが使えません。

URL形式を変えると過去記事が404になったりするので、
うかつに変えられず、プラグインは動いていないようです。

### マークダウンエディタについて

下記を使いつつ、
https://ja.wordpress.org/plugins/markdown-editor/

この旧エディタを開くということで
むりやりMarkdownのエディタプラグインを使っていました。
https://ja.wordpress.org/plugins/classic-editor/

改めて調べたところ、普通にClassic Editor使わなくても、
マークダウンをコピペして貼り付けると、
正しく解釈されました。

新しいエディタに変わったときは
確かちゃんと動かなかったはず。見直しって大事。

打ち消し記法も以前は表示バグがあり、
正しく打ち消しされてませんでしたが、
いつの間にかこれも解決していました。
[https://github.com/seothemes/markdown-editor/issues/5](https://github.com/seothemes/markdown-editor/issues/5)

結果、マークダウンについては抱えていた問題は
すべて解決していました。使い勝手もいいです。
見直しって大事ですね。

### ソーシャル拡散されやすさ

はてブの新着エントリーを改めて見たところ、
時間順に最新のエントリーが表示されているわけではないんですね。

新着エントリーに載せる記事のアルゴリズムが
はてブ側で変更され、厳しくなったようです。
そのため、はてブ村にいるからと言って、
拡散されやすさはコンテンツ力が必要ですね。

こうなってくると、
いよいよWordPressと大差ないような気がしてきました。

### 目次機能

この記事にある通り、ちゃんと表示できました。
パッと見で、この記事には何が書いてあるかわかりやすくなったので、
けっこういい感じだと思います。
プラグインインストールさえすれば、自動で目次が生成されます。

## 結論

WordPressからはてなブログへの移行コストと、
解決できることの効果が釣り合わないので、
今回、移行はやめました。
調査始める前に抱いていた課題点は
実際にWordPressの修正を行うことで
だいたい解決してしまったのもあります。

この結論は僕の場合ですので、
ご参考までにと言ったところですが、
はてなブログがいいとかWordPressがいいとかは
人によります。

まっさらな状態で、これからブログやってみたいって人であれば、
最初からはてなブログでやるのが楽そうです。

僕が元々WordPressを利用始めたのは、
サーバやウェブサイトの管理について勉強するためでした。
実際にサービスとして回さないと、
正解とか間違いとかが分かりづらかったりするので、
これからエンジニアになるぞって人には、おすすめできたりします。

こんだけ長文書いといて移行しないんか〜いみたいのあるかもしれないので、
一応下記は課題として、これから対応を行う予定です。

* HTTPS対応
* 表示速度改善のためにサーバ側の各種設定見直し
* URL形式見直し

## まとめ

課題を洗い出し、ちゃんとした調査の上で
移行しないと決められて、スッキリしました。
ここ1年くらいずっとモヤモヤしてたブログ管理について、
改めて考えられることができ、
問題だと思ってたことがすでに解決済みだったり、
隣の芝生は青かっただけだったりが多かったです。

たかがブログ、されどブログということで、
WordPressの設定で苦労してみたり、
はてなブログで意外と拡散されなくて悩んだりは
エンジニアとしてはいい経験になりそうです。

ブログを書き始めるきっかけになった[SOFT SKILLS](https://amzn.to/2nKDP6w)という本に、
なぜエンジニアはブログを書くべきかがまとまってるので、
ぜひ読んでみてください。

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="//rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=birdmangai-22&language=ja_JP&o=9&p=8&l=as4&m=amazon&f=ifr&ref=as_ss_li_til&asins=B01GDS0994&linkId=c0b45674a1765c96e6a05e2b68d5f76f"></iframe>

